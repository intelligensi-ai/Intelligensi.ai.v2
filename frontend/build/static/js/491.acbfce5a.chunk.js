"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[491],{264:(e,t,s)=>{s.d(t,{Q:()=>r});const r=async e=>{if(null===e||void 0===e||!e.site_url)throw new Error("No site URL provided");const t=(e=>{try{let t=e;return t.startsWith("http://")||t.startsWith("https://")||(t=`https://${t}`),t=t.replace(/\/$/,""),`${t}/api/bulk-export`}catch(t){return console.error("Error constructing endpoint URL:",t),null}})(e.site_url);if(!t)throw new Error("Invalid site URL");const s="http://127.0.0.1:5001/intelligensi-ai-v2/us-central1";const r=`${s}/drupal7/structure?endpoint=${encodeURIComponent(t)}`,n=await fetch(r);if(!n.ok)throw new Error(`Server returned ${n.status}: ${n.statusText}`);return(await n.json()).structure||[]}},491:(e,t,s)=>{s.r(t),s.d(t,{default:()=>i});var r=s(43),n=s(213),o=s(264),l=s(579);const i=e=>{let{site:t,onComplete:s,onError:i,onClose:a}=e;const[c,d]=(0,r.useState)([]),[h,u]=(0,r.useState)(!1),[x,m]=(0,r.useState)(0),[p,g]=(0,r.useState)(!1),[f,v]=(0,r.useState)(0),[b,j]=(0,r.useState)(null);(0,r.useEffect)((()=>{(async()=>{try{g(!0),j(null);const e=await(0,o.Q)(t);if(0===e.length)return void j("No content available to vectorize from this site.");d(e),v(e.length)}catch(e){console.error("Failed to fetch Drupal content:",e),j("Could not connect to the site. Please check your connection and try again."),i("Could not fetch Drupal content")}finally{g(!1)}})()}),[t]);const y=e=>{if(!e)return"";const t=document.createElement("textarea");t.innerHTML=e;let s=t.value;return s=s.replace(/<[^>]*>?/gm,"").replace(/\\(r|n|"|')/g,"").replace(/\s+/g," ").trim(),s};return b?(0,l.jsxs)("div",{className:"bg-[#2D3748] rounded-lg p-6 w-full ",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-white",children:"Error"}),(0,l.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-white transition-colors",children:(0,l.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,l.jsx)("div",{className:"bg-[#1F2937] border border-red-500/50 rounded-lg p-4 mb-6",children:(0,l.jsxs)("div",{className:"flex items-start text-gray-200",children:[(0,l.jsx)("svg",{className:"w-5 h-5 mr-3 text-red-500 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,l.jsx)("span",{className:"text-sm",children:b})]})}),(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsx)("button",{onClick:a,className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded transition-colors text-sm font-medium",children:"Close"})})]}):(0,l.jsxs)("div",{className:"bg-[#2D3748] rounded-lg  max-w-4xl",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsxs)("h2",{className:"text-xl font-bold text-white",children:["Vectorize Content from ",t.site_name]}),(0,l.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-white",children:(0,l.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,l.jsx)("span",{className:"text-sm font-medium text-teal-400",children:"Progress"}),(0,l.jsxs)("span",{className:"text-sm text-gray-400",children:[x,"%"]})]}),(0,l.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2.5",children:(0,l.jsx)("div",{className:"bg-teal-500 h-2.5 rounded-full transition-all duration-300",style:{width:`${x}%`}})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 max-h-96 overflow-y-auto",children:[c.slice(0,6).map((e=>(0,l.jsxs)("div",{className:"bg-[#344054] p-3 rounded border border-gray-600",children:[(0,l.jsx)("h3",{className:"font-bold text-teal-400 truncate",children:e.title}),(0,l.jsx)("p",{className:"text-gray-300 text-sm line-clamp-2",children:y(e.body)}),(0,l.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:[e.type," | ",e.nid]})]},e.nid))),c.length>6&&(0,l.jsx)("div",{className:"bg-[#344054] p-3 rounded border border-gray-600 flex items-center justify-center",children:(0,l.jsxs)("span",{className:"text-gray-400",children:["+",c.length-6," more items"]})})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-700",children:[(0,l.jsx)("button",{onClick:a,disabled:h,className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded transition-colors",children:"Cancel"}),(0,l.jsx)("button",{onClick:async()=>{try{if(!c.length)return void j("No content available to vectorize");u(!0),m(0),j(null);const e=5;let r=0;for(let t=0;t<c.length;t+=e){const s=c.slice(t,t+e);for(let e=0;e<s.length;e++){const o=s[e];try{const e={objects:[o].map((e=>({class:"IntelligensiAi",properties:{nid:e.nid,title:e.title,body:y(e.body),created:e.created,status:"1"===e.status?"published":"unpublished",type:e.type}})))},t="http://127.0.0.1:5001/intelligensi-ai-v2/us-central1";if(!t)return console.error("CRITICAL: REACT_APP_API_BASE_URL is not defined. Ensure it is set in your .env file for the frontend."),j("Application configuration error: API endpoint is missing."),void u(!1);await n.A.post(`${t}/writeWeaviate`,e,{headers:{"Content-Type":"application/json"}}),r++}catch(b){console.error(`Failed to vectorize item ${o.nid}:`,b)}finally{const s=t+e+1,r=Math.round(s/c.length*100);m(r)}}}s({objectsCreated:r,siteName:t.site_name})}catch(b){var e,r;console.error("Vectorization error:",b);const s=(null===(e=b.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.message)||b.message||"Failed to vectorize content";j(s),i(s)}finally{u(!1)}},disabled:h||p||!c.length,className:"px-4 py-2 rounded text-white transition-colors "+(h||p||!c.length?"bg-gray-600 cursor-not-allowed":"bg-teal-600 hover:bg-teal-500"),children:p?"Loading Content...":h?(0,l.jsxs)("span",{className:"flex items-center",children:[(0,l.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Vectorizing..."]}):`Vectorize ${f} Items`})]})]})}}}]);
//# sourceMappingURL=491.acbfce5a.chunk.js.map